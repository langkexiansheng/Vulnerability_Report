from docx import Document
from docx.shared import Inches

class DocxMake():

	def docxmake(corename, imagename, docxname):
		document = Document()

		document.add_heading('1.	solr远程代码执行漏洞', 0)

		document.add_heading('1.1.	漏洞定位', level=1)
		document.add_paragraph(corename, style="Normal")

		document.add_heading('1.2.	风险分析', level=1)
		document.add_paragraph('网站使用了存在漏洞的组件solr<8.2.0，攻击者可直接获取操作系统控制权。', style="Normal")

		document.add_heading('1.3.	漏洞验证过程', level=1)
		document.add_paragraph('利用漏洞证明工具执行 whoami命令如下：', style="Normal")
		document.add_picture(imagename, width=Inches(7))

		document.add_heading('1.4.	安全建议', level=1)
		document.add_paragraph('升级solr至最新版本。', style="Normal")

		document.add_page_break()
		document.save(docxname)